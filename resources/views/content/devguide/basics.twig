{% extends 'PlentyPluginShowcase::templates.ExamplePage' %}

{% block Content %}

<h1 id="plugin-structure">Plugin structure</h1>
<div class="api-docs-basics">
    <p>
        All plugins need to be organised in a specific structure. You can create a new plugin from a Git repository. This will create all required files and folders automatically as follows:
    </p>
</div>

<div class="code-container">
<pre class="prettyprint lang-plain grey-back">
PluginDirectory/
    +-- meta/
    |   +-- images/
    |       |   // preview images showing this plugin
    |       +-- preview_[0-6].[png | jpeg]
    |       |   // plugin icons
    |       +-- icon_plugin_[xs | sm | md].[png | jpeg]
    |       |   // authors logo
    |       +-- icon_author_[xs | sm | md].[png | jpeg]
    |
    +-- resources/
    |   +-- css/
    |   |   +-- // .css and .scss files
    |   +-- images/
    |   |   +-- // images
    |   +-- js/
    |   |   +-- // JavaScript and CoffeeScript
    |   +-- lang/
    |   |   +-- // language files
    |   +-- documents/
    |   |   +-- // fonts, pdf-files or other resources
    |   +-- views/
    |       +-- // twig templates (can be organised in sub-folders)
    |
    +-- src/
    |   +-- // plugin source code
    |
    |-- test/
    |   +-- // tests will be executed before build
    |
    +-- config.json // <a href="#plugin-options">admin's plugin options</a>
    +-- plugin.json // <a href="#plugin-information">plugin information</a>
    +-- README.md
</pre>
</div>

<div class="api-docs-basics">
    <p>
        For detailed information about the different plugin components, refer to the <a href="components#components-introduction">Components</a> page.
    </p>
</div>

<h2 id="plugin-information">Plugin information</h2>
<div class="api-docs-basics">
    <p>
        All information about your plugin is defined in a <code>plugin.json</code> file. This file defines the service
        provider of your plugin, which will be called by plentymarkets to register and run your plugin.
    </p>

    <table class="table table-striped table-responsive table-bordered table-hover">
        <thead>
            <tr>
                <th>Property</th>
                <th>Description</th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>version</td>
                <td>The version of your plugin. We recommend to use <a href="http://semver.org/" target="_blank">semantic versioning</a>.</td>
            </tr>
            <tr>
                <td>name</td>
                <td>The name of your plugin</td>
            </tr>
            <tr>
                <td>description</td>
                <td>The description of your plugin</td>
            </tr>
            <tr>
                <td>author</td>
                <td>The author of the plugin</td>
            </tr>
            <tr>
                <td>keywords</td>
                <td>An array of keywords describing your plugin</td>
            </tr>
            <tr>
                <td>type</td>
                <td>The type of your plugin. Use "<i>export</i>" for plugins defining new export formats or "<i>template</i>" for frontend plugins.</td>
            </tr>
            <tr>
                <td>require</td>
                <td>An array of dependencies of other plugins including required version, e.g. <i>PlentyPluginShowcase-1.0.0</i></td>
            </tr>
            <tr>
                <td>namespace</td>
                <td>The root namespace of your plugin</td>
            </tr>
            <tr>
                <td>serviceProvider</td>
                <td>The service provider to hook-up</td>
            </tr>
        </tbody>

    </table>
</div>

<div class="route-container">
<code>/plugin.json</code>
</div>

<div class="code-container grey-back">
    <pre class="prettyprint lang-js grey-back linenums">
{
    "version"           : 0.1,
    "name"              : "MyPlugin",
    "description"       : "Description of your plugin",
    "author"            : "Your name",
    "keywords"          : ["plentymarkets", "plugins"],
    "type"              : "template",
    "require"           : [],
    "namespace"         : "PluginNamespace",
    "serviceProvider"  : "PluginNamespace\\Providers\\MyServiceProvider"
}</pre>
</div>

<h2 id="plugin-options">Admin options</h2>
<div class="api-docs-basics">
    <p>
        You can define multiple options that will be displayed in the <b>Start » Plugins » Tab: Plugins</b> menu to be configured by admin users.
        The value of each option can be accessed in your PHP code by using the <code>ConfigRepository</code> or from
        Twig templates by using the <code>config()</code> macro.
    </p>

    <p>
        All admin options can be defined in an array of configurations in the <code>config.json</code>. Each configuration needs
        the following properties:
    </p>

    <table class="table table-striped table-responsive table-bordered table-hover">
        <thead>
            <tr>
                <th>Property</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
              <td>tab</td>
              <td>Organises the <code>config.json</code> options into tabs. Tabs are optional.</td>
            </tr>
            <tr>
                <td>key</td>
                <td>The identifier of the configuration. This key can be used to access the options value.</td>
            </tr>
            <tr>
                <td>label</td>
                <td>The label of this configuration. Will be displayed in the <b>Start » Plugins » Tab: Plugins</b> menu.</td>
            </tr>
            <tr>
                <td>type</td>
                <td>Defines the presentation of this configuration. Possible values:<br /><b>"dropdown"</b> = Possible values are displayed in a drop-down menu.<br /><b>"text"</b> = Displays a text field for text input.<br /><b>"checkbox"</b> = Displays a checkbox.<br /><b>"multi_select"</b> = Displays a multi-select box. Possible values can be activated or deactivated.<br /><b>"category_select"</b> = Displays a category picker.</td>
            </tr>
            <tr>
                <td>possibleValues</td>
                <td>Defines available values of a dropdown or multi-select option (obsolete if type is "text", "checkbox" or "category_select")</td>
            </tr>
            <tr>
                <td>default</td>
                <td>The default value of this option</td>
            </tr>
        </tbody>
    </table>
</div>
<div class="route-container">
<code>/config.json</code>
</div>
<div class="code-container">
    <pre class="prettyprint lang-js grey-back linenums">
[
    {
        "tab"       : "Categories",
        "key"       : "global.category.home",
        "label"     : "Home page",
        "type"      : "category_select"
    },
    {
        "tab"       : "Header",
        "key"       : "header.company_logo_align",
        "label"     : "Align company logo",
        "type"      : "dropdown",
        "possibleValues": {
            "0" : "Left",
            "1" : "Center",
            "2" : "Right"
        },
        "default"   : "0"
    },
    {
        "tab"       : "Footer",
        "key"       : "footer.col_1_title",
        "label"     : "Title of first column",
        "type"      : "text",
        "default"   : "Shop"
    },
    {
        "tab"       : "Item",
        "key"       : "item.data",
        "label"     : "Show item information",
        "type"      : "multi_select",
        "possibleValues": {
            "item.technical_data": "Technical data",
            "item.description": "Description"
        },
        "default"   : "all"
    },
    {
       "tab"       : "Basket",
       "key"       : "basket.variations",
       "label"     : "Show Change variation button",
       "type"      : "checkbox",
       "default"   : true
   }
]</pre>
</div>

<h4>Accessing plugin options from <code>PhpClass.php</code></h4>
    <div class="code-container">
        <pre class="prettyprint lang-php grey-back linenums">
// access configuration from PHP
function getTitle(ConfigRepository $config):string
{
    if( $config->get('MyPlugin.show_title') == "1" )
    {
        return $config->get('MyPlugin.title_text');
    }
    else
    {
        return "";
    }
}</pre>
    </div>

<h4>Accessing plugin options from <code>Template.twig</code></h4>
<div class="code-container">
<pre class="prettyprint lang-twig grey-back linenums">
{% verbatim %}{% if config('MyPlugin.show_title') == "1" %}
    &lt;h1&gt;{{ config('MyPlugin.title_text') }}&lt;/h1&gt;
{% endif %}
{% endverbatim %}</pre>
</div>

<h2 id="guide-interface">Plugin interfaces</h2>

<div class="api-docs-basics">
    <p>
        Interfaces define the core services for plentymarkets plugins. Interfaces contain all necessary methods <!-- properties, events etc. --> for your plugin to communicate with plentymarkets. For each module of plentymarkets, individual interfaces are available:
    </p>
    <table class="table table-striped table-responsive table-bordered table-hover">
      <thead>
        <tr>
        <th>
          Interface
        </th>
        <th>
          Description
        </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <a href="{{ url() }}/api-doc/Account">Account</a>
          </td>
          <td>
            Contains sub-modules for <strong>Addresses</strong> and <strong>Contacts</strong>. This interface is the counterpart to the plentymarkets CRM module.
          </td>
        </tr>
      <tr>
        <td>
          <a href="{{ url() }}/api-doc/Accounting">Accounting</a>
        </td>
        <td>
          Contains a sub-module for <strong>VAT</strong> and classes for determining the VAT.
        </td>
      </tr>
      <tr>
      <td>
        <a href="{{ url() }}/api-doc/Authorization">Authorization</a>
      </td>
      <td>
        Interface for user access control and role access control.
      </td>
      </tr>
      <tr>
      <td>
        <a href="{{ url() }}/api-doc/Basket">Basket</a>
      </td>
      <td>
        Contains sub-modules for determining the basket and the items within the basket.
      </td>
      </tr>
      <tr>
      <td>
        <a href="{{ url() }}/api-doc/Category">Category</a>
      </td>
      <td>
        Interface with sub-modules and models for categories.
      </td>
      </tr>
        <tr>
            <td>
                <a href="{{ url() }}/api-doc/Cron">Cron</a>
            </td>
            <td>
                Interface for accessing cron jobs.
            </td>
        </tr>
      <tr>
      <td>
        <a href="{{ url() }}/api-doc/DataExchange">DataExchange</a>
      </td>
      <td>
        Interface for exchanging data. Contains models for export and filters.
      </td>
      </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/Document">Document</a>
      </td>
      <td>
        Contains the document model.
      </td>
      </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/Frontend">Frontend</a>
      </td>
      <td>
        Interface with services for the online store.
      </td>
      </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/Helper">Helper</a>
      </td>
      <td>
        Interface with contracts, models and services for helpers.
      </td>
      </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/Item">Item</a>
      </td>
      <td>
        Contains sub-modules for attributes, availability, item and variation data, manufacturers, shipping and units.
      </td>
      </tr>
        <tr>
            <td>
                <a href="{{ url() }}/api-doc/ItemSet">ItemSet</a>
            </td>
            <td>
                Interface for item sets. Contains methods to get and create item sets and item set components.
            </td>
        </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/Market">Market</a>
      </td>
      <td>
        Contains the sub-module <strong>Ebay</strong> for fitments and fitment items.
      </td>
      </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/Order">Order</a>
      </td>
      <td>
        Contains contracts and models for orders and order items as well as the sub-modules <strong>Currency</strong>, <strong>Payment</strong> and <strong>Shipping</strong>. This interface is the counterpart to the plentymarkets order module.
      </td>
      </tr>
        <tr>
            <td>
                <a href="{{ url() }}/api-doc/Payment">Payment</a>
            </td>
            <td>
                Contains the sub-modules for payment methods, the payment history, as well as contracts and models for payments and payment properties.
            </td>
        </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/StockManagement">StockManagement</a>
      </td>
      <td>
        Contains contracts and models for stock management and storage data.
      </td>
      </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/System">System</a>
      </td>
      <td>
        Contains the <strong>Webstore</strong> model.
      </td>
      </tr>
      <tr>
      <td>
      <a href="{{ url() }}/api-doc/Template">Template</a>
      </td>
      <td>
        Contains contracts and models for the design and design configuration.
      </td>
      </tr>
        <tr>
            <td>
                <a href="{{ url() }}/api-doc/Ticket">Ticket</a>
            </td>
            <td>
                Contains contracts and models related to the plentymarkets ticket system.
            </td>
        </tr>
    </tbody>
    </table>
</div>

<h1 id="plugin-provisioning">Plugin provisioning</h1>

<div class="api-docs-basics">
    <p>
        After creating a plugin with the respective structure and files, the plugin needs to be provisioned. Let's have a look on how to provision a plugin.
    </p>
</div>

<h2 id="add-repository">Adding a Git repository to the plentymarkets inbox</h2>
<div class="api-docs-basics">

<p>Proceed as described here to add a Git repository to your plentymarkets inbox.</p>

<ol>
<li>Go to <strong>Start » Plugins » Tab: Plugins</strong>.</li>
<li>Click on <strong>Add plugin</strong>.<br />
→ The <strong>New plugin</strong> window is displayed.</li>
<li>Click on <strong>Git</strong>.<br />
→ The <strong>Settings</strong> window opens.</li>
<li>Enter the login details for the Git repository.</li>
<li>Click on <strong>Test connection</strong>.<br />
&rarr; Connectivity to the Git repository is checked and established.<br />
&rarr; The drop-down menu <strong>Branch</strong> can be selected.</li>
<li>Select the branch of the repository that you want to clone and edit.</li>
<li><strong>Save</strong> your settings.<br />
→ The plugin repository is cloned to the plentymarkets inbox.<br />
→ The plugin is added to the plugin list.<br />
→ The plugin is added to the plugins in the <strong>Git</strong> tab.</li>
</ol>
</div>


<h2 id="provisioning">Provisioning plugins</h2>
<div class="api-docs-basics">


    <p>
        The provisioning process is started from the <b>Start » Plugins » Tab: Plugins</b> menu of the plentymarkets backend. Before provisioning, select the clients (stores) that you want to provision the plugins for.</p>
    <ul>
        <li>Clicking the <b>Paper airplane</b> icon will start the provisioning process for all plugins that have a check mark in the <b>Stage</b> column of the plugin list.</li>
        <li>Clicking on the <b>Globe</b> icon will start the provisioning process for all plugins that have a check mark in the <b>Productive</b> column.<br />
        &rarr; You can not start the provisioning process for individual plugins.<br />
        &rarr; By default, the check mark is identical to the current state of the plugin in the environment. Newly added plugins have a check mark by default.</li>
    </ul>

    <p>
    You need to provision the plugins if one of the following has occurred since the last provisioning process:
    </p>

    <ul>
        <li>new plugins were added and activated</li>
        <li>plugins were updated</li>
        <li>plugins were activated</li>
        <li>plugins were deactivated</li>
        <li>provisioning errors were fixed</li>
        <li>currently provisioned plugins were deleted</li>
    </ul>

</div>

<h1 id="ide-setup">Setting up an IDE</h1>
    <div class="api-docs-basics">
        <p>
            We recommend using <a href="https://www.jetbrains.com/phpstorm/" target="_blank">PhpStorm</a>. PhpStorm is a comprehensive IDE which supports all PHP language features. PhpStorm also includes a wide range of leading edge front-end technologies, such as CSS, Sass, Javascript, as well as Twig syntax highlighting. PhpStorm supports <a href="http://eslint.org/" target="_blank">ESLint</a>, a linting utility plugin for JavaScript.
        </p>
    </div>
    <h2 id="install-nodejs">Installing Node.js</h2>
    <div class="api-docs-basics">
        <p>For JavaScript packages, such as <a href="http://gulpjs.com/" target="_blank">Gulp</a>, we recommend installing <a href="https://nodejs.org/en/about/" target="_blank">Node.js</a> with its package manager <a href="https://www.npmjs.com/" target="_blank">npm</a>.</p>
    <ol>
    <li>
        Download and install <a href="https://nodejs.org/en/download/" target="_blank">Node.js</a>.<br />&rarr; We recommend using Node.js v6.9.1 LTS.
    </li>
        <li>
            To use Node.js properly, a command line tool is required. PhpStorm comes with a built-in terminal, but you can use any other command line tool.
        </li>
    </ol>
    </div>
<h2 id="install-phpstorm">Installing PhpStorm</h2>
    <div class="api-docs-basics">
        <p>Next, install PhpStorm and the Twig language plugin.</p>
        <ol>
            <li>
                Download and install <a href="https://www.jetbrains.com/phpstorm/download/" target="_blank">PhpStorm</a>.<br />&rarr; We recommend using PhpStorm v2016.2.2.
            </li>
            <li>
                Open PhpStorm.<br />&rarr; The <b>Welcome to PhpStorm</b> window will open.
            </li>
            <li>
                Click on <b>Configure » Plugins</b>.<br />&rarr; The <b>Plugins</b> window will open.
            </li>
            <li>
                Click on <b>Install JetBrains plugin...</b>.<br />&rarr; The <b>Browse JetBrains Plugins</b> will open.
            </li>
            <li>
                Install the <b>Twig Support</b> plugin.
            </li>
        </ol>
    </div>

    <h2 id="config-phpstorm-callisto">Configuring PhpStorm for Callisto 4</h2>

    <div class="api-docs-basics">
        <p>Clone or download the <a href="https://github.com/plentymarkets/callisto-4" target="_blank">Callisto 4</a> and <a href="https://github.com/plentymarkets/layout-core-4" target="_blank">LayoutCore</a> plugins, e.g. with <a href="https://desktop.github.com/" target="_blank">GitHub Desktop</a> or <a href="https://www.sourcetreeapp.com/" target="_blank">SourceTree</a>.</p>
        <ol>
            <li>
                Open PhpStorm.<br />&rarr; The <b>Welcome to PhpStorm</b> window will open.
            </li>
            <li>
                Click on <b>Open</b>.<br />&rarr; The <b>Open File or Project</b> window will open.
            </li>
            <li>
                Select your <b>Callisto 4</b> folder and click <b>OK</b>.
            </li>
            <li>
                Open the terminal and go to the Callisto project folder.<br />&rarr; When using the built-in terminal of PhpStorm, you are already in the right project folder.
            </li>
            <li>
                Run <code>npm install</code> in the terminal.<br />&rarr; All dependencies that are defined in the <code>package.json</code> file are installed.
            </li>
            <li>
                Click on <b>PhpStorm » Preferences...</b> in the menu bar.
            </li>
            <li>
                Go to <b>Languages & Frameworks » JavaScript » Code Quality Tools » ESLint</b>.
            </li>
            <li>
                <b>Enable</b> ESLint for the Callisto project.
            </li>
        </ol>
    </div>
<h2 id="gulp-callisto">Gulp tasks for Callisto 4</h2>

<div class="api-docs-basics">
    <p>Gulp is a streaming build system that helps you automating your JavaScript tasks. The following Gulp tasks are available in the Callisto 4 project.</p>
    <table class="table table-striped table-responsive table-bordered table-hover">
        <thead>
        <tr>
            <th>Task</th>
            <th>Description</th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td><b>watch:js</b></td>
            <td>includes the <b>build:vendor</b> task. This task monitors all <code>.js</code> files in the <b>resources/js/src/app</b> folder and builds <code>.js</code> files in the <b>resources/js/dist</b> folder in case of changes.</td>
        </tr>
        <tr>
            <td><b>watch:sass</b></td>
            <td>monitors all <code>.scss</code> files in the <b>resources/scss</b> folder and builds <code>.css</code> files in the <b>resources/css</b> folder in case of changes.</td>
        </tr>
        <tr>
            <td><b>build</b></td>
            <td>includes the <b>build:bundle</b> and <b>build:sass-min</b> tasks</td>
        </tr>
        <tr>
            <td><b>build:bundle</b></td>
            <td>includes the <b>build:app</b>, <b>build:vendor</b> and <b>build:lang</b> tasks. This task builds the <code>.js</code> and <code>.min.js</code> files in the <b>resources/js/dist</b> folder.</td>
        </tr>
        <tr>
            <td><b>build:app</b></td>
            <td>includes the <b>build:lint</b> task. This task builds <code>-app.js</code> files in the <b>resources/js/dist</b> folder.</td>
        </tr>
        <tr>
            <td><b>build:lang</b></td>
            <td>builds the <code>.js</code> files in the <b>resources/js/lang</b> folder</td>
        </tr>
        <tr>
            <td><b>build:vendor</b></td>
            <td>builds <b>-vendor.js</b> files in the <b>resources/js/dist</b> folder</td>
        </tr>
        <tr>
            <td><b>build:lint</b></td>
            <td>executes ESLint and lints <code>.js</code> files in the <b>resources/js/src</b> folder</td>
        </tr>
        <tr>
            <td><b>build:sass-min</b></td>
            <td>includes the <b>build:sass</b> task. This task builds <b>.min.css</b> files in the <b>resources/css</b> folder.</td>
        </tr>
        <tr>
            <td><b>build:sass</b></td>
            <td>builds <code>.css</code> files in the <b>resources/css</b> folder</td>
        </tr>
        </tbody>

    </table>
</div>
    <h1 id="ide-support">Other IDEs</h1>
<h2 id="atom">Atom</h2>
<div class="api-docs-basics">
    <p>Atom is a customisable editor working across operating systems. It can be extended to also support Twig syntax.</p>
</div>
<h3>Installation</h3>
<div class="api-docs-basics">
    <ol>
        <li>
            <a href="https://github.com/atom/atom/releases/latest" target="_blank">Download</a>
            and <a href="https://atom.io/docs/latest/getting-started-installing-atom" target="_blank">install</a>
            Atom IDE
        </li>
        <li>
            <a href="https://atom.io/packages/php-twig" target="_blank">Install Twig Plugin</a><sup>*</sup> for Twig syntax highlighting
        </li>
    </ol>
    <p>
        *) All required Atom packages can be found using the embedded package control pane of the Atom IDE. This pane can be found in Atom: <i>Settings</i> > <i>Install</i>.
    </p>
</div>
<h2 id="sublime-text">Sublime Text</h2>

<div class="api-docs-basics">
    <p>As an alternative to the PhpStorm and Atom IDEs, we also recommend Sublime Text with the respective plugins for syntax highlighting.</p>
</div>

<h3>Installation</h3>
<div class="api-docs-basics">
    <ol>
        <li><a href="https://www.sublimetext.com/2" target="_blank">Install Sublime Text</a></li>
        <li>Install Sublime Text's <a href="https://packagecontrol.io/installation" target="_blank">Package-Control</a></li>
        <li>Install <a href="https://packagecontrol.io/packages/PHP-Twig" target="_blank">Twig Plugin</a></li>
    </ol>
</div>

{% endblock %}
